# Разработка Линейной Модели для Определения Стоимости Автомобиля и Реализация FastAPI Веб-Сервиса
## Этот проект выполнен в рамках первой практической работы круса "Практический Machine Learning" магистерской программы МОВС НИУ ВШЭ.

##Цель проекта
Целью проекта было создание линейной модели, предсказывающей стоимость автомобиля на основе характеристик автомобиля, а также разработка веб-сервиса на FastAPI для развертывания этой модели.

##ML-метрики модели: 

* R2 и MSE.

##Бизнес-метрика модели: 

* Доля точных предсказаний (отклонение от реальной цены не более 10%).

##Веб-сервис должен обеспечивать:

* Предсказание стоимости одного объекта в формате JSON.
* Предсказание стоимости для группы объектов, представленных в виде CSV-файла.

##Этап 1: Исходные Данные
Использовались два набора данных: cars_train.csv и cars_test.csv, содержащие информацию о характеристиках и ценах автомобилей.

##Этапы Работы над Проектом
Загрузка и предобработка Данных

##Изучение и анализ исходных данных.
* Очистка данных от дубликатов и пропусков.
* Преобразование и нормализация значений признаков.


##Этап 2: Исследовательский Анализ Данных (EDA)

* Анализ распределений числовых признаков и целевой переменной.
* Создание тепловых карт корреляций между признаками.
* Визуализация данных через графики распределений и диаграммы размаха.
* Основные Наблюдения
* Попарные Распределения и Корреляции

Отмечены:

* Похожие распределения признаков в тренировочном и тестовом наборах данных.
* Замечена положительная корреляция между годом выпуска и стоимостью, а также между характеристиками двигателя и стоимостью.
* Отрицательная корреляция между пробегом и стоимостью.

##Тепловая Карта Корреляций

* Низкая корреляция между годом выпуска и объемом двигателя.
* Высокая корреляция между характеристиками двигателя.

##Анализ Распределений

Ненормальное распределение большинства признаков.
Наличие выбросов в данных.


##Этап 3: Машинное Обучение

На этом этапе мы сконцентрировались на обучении четырех разных линейных моделей:

* Модель Линейной Регрессии: Применялась к только числовым признакам как до, так и после процесса стандартизации, используя стандартные настройки.
* Модель Lasso: Работала с числовыми признаками после стандартизации. Процесс включал в себя настройку параметра alpha с помощью метода GridSearch.
* Модель ElasticNet: Также применялась к числовым признакам после стандартизации с настройкой параметров alpha и l1_ratio через GridSearch.
* Модель Ridge: Использовалась для числовых признаков после стандартизации и категориальных признаков после OneHotEncoding, с настройкой параметра alpha через GridSearch.

Наилучшие результаты по метрикам r2 и MSE были достигнуты с помощью модели Ridge, обученной на комбинации числовых и категориальных признаков.

Этап 4: Инженерия Признаков
Целью этапа было улучшение показателей модели путем оптимизации признаков. 

Этап выполнен за счет предложения полимиальных прихнаков. 
На данном этапе столкнулись с проблемой того, что в тестовых данных не присутствовали все варианы переменной seats, в связи с чем пришлось добавить их в тестовую часть.

Оптимизация Существующих Признаков:

Применение логарифмирования к признакам km_driven, engine, torque, max_torque_rpm.
Логарифмирование целевой переменной selling_price.
Ограничение значений признаков между 0.5 и 99.5 перцентилями.
Генерация Новых Признаков из Существующих:

Лучшая модель продемонстрировала r2 0.85 на тестовом наборе и бизнес-метрику 0.28.

Этап 5: Разработка и Тестирование Веб-Сервиса
На последнем этапе был разработан и протестирован веб-сервис, интегрирующий модель и все этапы предобработки данных в единый пайплайн для предсказания стоим
